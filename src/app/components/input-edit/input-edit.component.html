<div class="input-edit-container">
  <div class="header">
    <button class="back-button" (click)="back()">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M15 18l-6-6 6-6"/>
      </svg>
    </button>
    <h2>Input Configuration</h2>
  </div>

  <div class="input-edit-form">
    <div class="basic-settings">
      <div class="form-group">
        <label for="name">Input Name</label>
        <input id="name" type="text" [(ngModel)]="input.name" placeholder="Enter input name" />
      </div>

      <div class="form-group">
        <label for="type">Input Type</label>
        <select id="type" [(ngModel)]="input.type" (change)="updateEvents()">
          <option value="BTN">Button</option>
          <option value="SW">Switch</option>
          <option value="INVSW">Toggle Switch</option>
        </select>
      </div>
    </div>

    <h3>Events</h3>

    <div class="events-container">
      <div *ngFor="let event of input.events; let i = index" class="event-card">
        <div class="event-header">
          <h4>Event: {{ event.event }}</h4>
        </div>

        <div class="actions-container">
          <div *ngFor="let action of event.actions; let j = index" class="action-card">
            <div class="action-grid">
              <div class="form-group">
                <label>Output</label>
                <select [(ngModel)]="action.outputID" (ngModelChange)="onOutputChange(action)">
                  <option *ngFor="let output of outputs" [ngValue]="output.outputID">
                    {{ output.name }}
                  </option>
                </select>
              </div>

              <div class="form-group">
                <label>Action</label>
                <select [(ngModel)]="action.action">
                  <option value="on">On</option>
                  <option value="off">Off</option>
                  <option value="toggle">Toggle</option>
                </select>
              </div>

              <div class="form-group" *ngIf="action.action == 'on'">
                <label>Duration (sec)</label>
                <input type="number" [(ngModel)]="action.duration" min="0" />
              </div>

              <button class="remove-button" (click)="removeAction(i, j)" title="Remove action">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <line x1="18" y1="6" x2="6" y2="18"/>
                  <line x1="6" y1="6" x2="18" y2="18"/>
                </svg>
              </button>
            </div>
          </div>
        </div>

        <button class="add-button" (click)="addAction(i)">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="12" y1="5" x2="12" y2="19"/>
            <line x1="5" y1="12" x2="19" y2="12"/>
          </svg>
          Add Action
        </button>
      </div>
    </div>

    <div class="form-actions">
      <button class="save-button" (click)="save()">Save Changes</button>
    </div>
  </div>
</div>
